<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>alimOS - Futuristic Mobile OS</title>
    <style>
        /* CSS Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        }
        
        :root {
            /* Дизайн-система */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --radius-xl: 28px;
            --radius-full: 9999px;
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --shadow-sm: 0 2px 12px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 8px 32px rgba(0, 0, 0, 0.12);
            --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.16);
            --glass-blur: blur(24px);
            --transition-fast: 150ms cubic-bezier(0.2, 0, 0, 1);
            --transition-base: 300ms cubic-bezier(0.2, 0, 0, 1);
            --transition-spring: 500ms cubic-bezier(0.34, 1.56, 0.64, 1);
            
            /* Цветовая палитра alimOS */
            --color-primary: 220, 90%, 56%;
            --color-secondary: 280, 90%, 56%;
            --color-surface: 0, 0%, 100%;
            --color-surface-variant: 0, 0%, 98%;
            --color-on-surface: 0, 0%, 12%;
            --color-on-surface-variant: 0, 0%, 35%;
            --color-background: 240, 20%, 99%;
            --color-background-variant: 240, 10%, 96%;
            --color-overlay: 0, 0%, 0%;
            
            /* Градиенты */
            --gradient-primary: linear-gradient(135deg, hsl(var(--color-primary)), hsl(var(--color-secondary)));
            --gradient-surface: linear-gradient(135deg, hsl(var(--color-surface)), hsl(var(--color-surface-variant)));
            --gradient-background: linear-gradient(135deg, hsl(var(--color-background)), hsl(var(--color-background-variant)));
            --gradient-background-rainbow: linear-gradient(135deg, 
                rgba(106, 17, 203, 0.08) 0%,
                rgba(37, 117, 252, 0.08) 25%,
                rgba(15, 184, 142, 0.08) 50%,
                rgba(245, 158, 11, 0.08) 75%,
                rgba(239, 68, 68, 0.08) 100%);
            
            /* Тёмная тема */
            --theme-dark: 240, 10%, 8%;
            --theme-dark-surface: 240, 8%, 14%;
            --theme-dark-on-surface: 0, 0%, 98%;
            --theme-dark-on-surface-variant: 0, 0%, 75%;
        }
        
        body.dark {
            --color-surface: var(--theme-dark-surface);
            --color-surface-variant: var(--theme-dark);
            --color-on-surface: var(--theme-dark-on-surface);
            --color-on-surface-variant: var(--theme-dark-on-surface-variant);
            --color-background: var(--theme-dark);
            --color-background-variant: var(--theme-dark);
            --color-overlay: 0, 0%, 100%;
            --gradient-surface: linear-gradient(135deg, hsl(var(--theme-dark-surface)), hsl(var(--theme-dark)));
            --gradient-background: linear-gradient(135deg, hsl(var(--theme-dark)), hsl(var(--theme-dark)));
            --gradient-background-rainbow: linear-gradient(135deg, 
                rgba(106, 17, 203, 0.12) 0%,
                rgba(37, 117, 252, 0.12) 25%,
                rgba(15, 184, 142, 0.12) 50%,
                rgba(245, 158, 11, 0.12) 75%,
                rgba(239, 68, 68, 0.12) 100%);
        }
        
        /* Базовые стили */
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
            color: hsl(var(--color-on-surface));
            transition: background var(--transition-base);
        }
        
        #app {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        /* Телефонный контейнер */
        .phone-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            max-width: 400px;
            max-height: 850px;
            background: hsl(var(--color-surface));
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            transition: all var(--transition-base);
            background: var(--gradient-background-rainbow);
        }
        
        @media (min-width: 768px) {
            .phone-container {
                position: relative;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 380px;
                height: 800px;
                border: 14px solid #000;
                border-radius: 44px;
                box-shadow: 
                    0 0 0 1px rgba(255, 255, 255, 0.1),
                    0 40px 80px rgba(0, 0, 0, 0.3);
            }
            
            .phone-container::before {
                content: '';
                position: absolute;
                top: -6px;
                left: 50%;
                transform: translateX(-50%);
                width: 120px;
                height: 28px;
                background: #000;
                border-radius: 0 0 16px 16px;
                z-index: 1000;
            }
            
            .phone-container::after {
                content: '';
                position: absolute;
                top: 6px;
                left: 50%;
                transform: translateX(-50%);
                width: 60px;
                height: 6px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 3px;
            }
        }
        
        /* Обои */
        .wallpaper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(160deg, 
                #0f0c29 0%, 
                #302b63 30%, 
                #24243e 70%);
            z-index: 0;
            overflow: hidden;
        }
        
        .wallpaper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(100, 219, 255, 0.15) 0%, transparent 50%);
            animation: pulse 20s infinite alternate;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        /* Экран блокировки */
        .lockscreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-xl) var(--spacing-lg);
            padding-top: 80px;
            transition: transform var(--transition-spring), opacity var(--transition-base);
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.2);
        }
        
        .lockscreen.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translateY(-100%);
        }
        
        .lockscreen-top {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            text-shadow: 0 1px 4px rgba(0, 0, 0, 0.5);
        }
        
        .lockscreen-time {
            font-size: 64px;
            font-weight: 200;
            letter-spacing: -3px;
            margin-top: 20px;
            color: white;
            text-shadow: 0 2px 12px rgba(0, 0, 0, 0.5);
            font-feature-settings: "tnum";
        }
        
        .lockscreen-date {
            font-size: 18px;
            font-weight: 400;
            opacity: 0.9;
            margin-bottom: 40px;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .unlock-hint {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 80px;
            color: rgba(255, 255, 255, 0.8);
            text-shadow: 0 1px 4px rgba(0, 0, 0, 0.5);
            animation: float 3s infinite ease-in-out;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .unlock-handle {
            width: 72px;
            height: 72px;
            margin-bottom: 16px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: var(--radius-full);
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: var(--glass-blur);
            border: 1.5px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            cursor: grab;
        }
        
        .unlock-handle:active {
            cursor: grabbing;
        }
        
        .unlock-handle::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.3) 0%, 
                rgba(255, 255, 255, 0.1) 100%);
            border-radius: var(--radius-full);
        }
        
        .unlock-arrow {
            font-size: 24px;
            color: white;
        }
        
        .unlock-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .unlock-progress-bar {
            width: 0%;
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 2px;
            transition: width 0.1s linear;
        }
        
        /* Статус бар */
        .status-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 44px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 var(--spacing-md);
            z-index: 10;
            backdrop-filter: var(--glass-blur);
            background: rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: white;
        }
        
        .status-left, .status-right {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 14px;
            font-weight: 500;
        }
        
        .battery {
            width: 24px;
            height: 12px;
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 3px;
            position: relative;
            overflow: hidden;
        }
        
        .battery::before {
            content: '';
            position: absolute;
            top: 1px;
            left: 1px;
            width: 85%;
            height: calc(100% - 2px);
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        
        .battery::after {
            content: '';
            position: absolute;
            right: -4px;
            top: 3px;
            width: 2px;
            height: 6px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 0 1px 1px 0;
        }
        
        /* Домашний экран */
        .home-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            padding-top: 44px;
            padding-bottom: 100px;
            overflow: hidden;
            z-index: 5;
            transition: transform var(--transition-spring);
        }
        
        .home-screen.hidden {
            transform: translateY(100%);
        }
        
        .app-grid {
            flex: 1;
            padding: var(--spacing-lg);
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--spacing-lg);
            align-content: start;
            overflow-y: auto;
        }
        
        .dock {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: var(--spacing-md);
            backdrop-filter: var(--glass-blur);
            background: rgba(255, 255, 255, 0.08);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }
        
        /* Шторка уведомлений */
        .notification-shade {
            position: absolute;
            top: -100%;
            left: 0;
            width: 100%;
            height: 65%;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: var(--glass-blur);
            z-index: 20;
            border-radius: 0 0 var(--radius-xl) var(--radius-xl);
            transition: transform var(--transition-spring);
            padding-top: 44px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .notification-shade.open {
            transform: translateY(100%);
        }
        
        .quick-settings {
            padding: var(--spacing-lg);
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--spacing-lg);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .setting-toggle {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all var(--transition-fast);
            cursor: pointer;
            color: white;
        }
        
        .setting-toggle.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .setting-toggle:active {
            transform: scale(0.92);
        }
        
        .setting-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }
        
        .notification-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-lg);
        }
        
        .notification {
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.08);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-sm);
            border-left: 4px solid hsl(var(--color-primary));
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .notification-text {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .notification-time {
            font-size: 12px;
            opacity: 0.6;
            margin-top: 4px;
        }
        
        /* Иконки приложений */
        .app-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-fast);
            -webkit-tap-highlight-color: transparent;
            position: relative;
        }
        
        .app-icon:active {
            transform: scale(0.92);
        }
        
        .app-icon-wrapper {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-lg);
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: var(--glass-blur);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .app-icon-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.2) 0%, 
                rgba(255, 255, 255, 0.05) 100%);
            opacity: 0;
            transition: opacity var(--transition-fast);
        }
        
        .app-icon.active .app-icon-wrapper::before {
            opacity: 1;
        }
        
        .app-name {
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            color: white;
            text-shadow: 0 1px 4px rgba(0, 0, 0, 0.5);
            padding: 2px 6px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        /* SVG иконки */
        .icon-svg {
            width: 28px;
            height: 28px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        /* Экраны приложений */
        .app-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-background-rainbow);
            transform: translateY(100%);
            transition: transform var(--transition-spring);
            z-index: 30;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .app-screen.open {
            transform: translateY(0);
        }
        
        .app-header {
            height: 56px;
            display: flex;
            align-items: center;
            padding: 0 var(--spacing-md);
            gap: var(--spacing-md);
            backdrop-filter: var(--glass-blur);
            background: rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: white;
            position: relative;
            z-index: 10;
        }
        
        .app-title {
            flex: 1;
            font-size: 17px;
            font-weight: 600;
            text-align: center;
            letter-spacing: -0.3px;
        }
        
        .app-content {
            flex: 1;
            overflow: hidden;
            position: relative;
            background: transparent;
        }
        
        .btn-back {
            width: 36px;
            height: 36px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
            color: white;
            font-size: 20px;
        }
        
        .btn-back:active {
            transform: scale(0.9);
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Приложение Phone */
        .dialer {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .dialer-display {
            padding: var(--spacing-xl);
            text-align: center;
            font-size: 48px;
            font-weight: 300;
            letter-spacing: 2px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            min-height: 140px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-feature-settings: "tnum";
        }
        
        .dialer-pad {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-lg);
            padding: var(--spacing-xl);
        }
        
        .dialer-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 76px;
            border-radius: var(--radius-full);
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 28px;
            font-weight: 300;
            cursor: pointer;
            transition: all var(--transition-fast);
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .dialer-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.2) 0%, 
                rgba(255, 255, 255, 0.05) 100%);
            opacity: 0;
            transition: opacity var(--transition-fast);
        }
        
        .dialer-btn:active::before {
            opacity: 1;
        }
        
        .dialer-btn:active {
            transform: scale(0.92);
        }
        
        .dialer-btn-sub {
            font-size: 11px;
            font-weight: 400;
            opacity: 0.6;
            margin-top: 4px;
            letter-spacing: 1px;
        }
        
        .call-history {
            padding: var(--spacing-md);
            height: 100%;
            overflow-y: auto;
        }
        
        .call-item {
            display: flex;
            align-items: center;
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-sm);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        /* Приложение Messages */
        .chat-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            height: 100%;
            overflow-y: auto;
        }
        
        .chat-item {
            display: flex;
            align-items: center;
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            background: rgba(255, 255, 255, 0.05);
            gap: var(--spacing-md);
            cursor: pointer;
            transition: all var(--transition-fast);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .chat-item:active {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .chat-avatar {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            background: var(--gradient-primary);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: 600;
            font-size: 20px;
        }
        
        .chat-content {
            flex: 1;
        }
        
        .chat-name {
            font-weight: 600;
            margin-bottom: 4px;
            color: white;
        }
        
        .chat-preview {
            font-size: 14px;
            opacity: 0.8;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .chat-conversation {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            height: calc(100% - 120px);
            overflow-y: auto;
        }
        
        .message {
            max-width: 80%;
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            position: relative;
            animation: messageAppear 0.3s cubic-bezier(0.2, 0, 0, 1);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message-incoming {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.08);
            border-top-left-radius: 4px;
            color: white;
        }
        
        .message-outgoing {
            align-self: flex-end;
            background: var(--gradient-primary);
            border-bottom-right-radius: 4px;
            color: white;
        }
        
        .message-input-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: var(--glass-blur);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .message-input-wrapper {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }
        
        .message-input {
            flex: 1;
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-full);
            color: white;
            font-size: 16px;
            outline: none;
        }
        
        .message-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .send-button {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            background: var(--gradient-primary);
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: transform var(--transition-fast);
        }
        
        .send-button:active {
            transform: scale(0.9);
        }
        
        /* Приложение Camera */
        .camera-viewfinder {
            flex: 1;
            background: linear-gradient(45deg, #0f0c29, #302b63, #24243e);
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .camera-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(to right, rgba(255,255,255,0.1) 1px, transparent 1px) 0 0 / 20px 20px,
                linear-gradient(to bottom, rgba(255,255,255,0.1) 1px, transparent 1px) 0 0 / 20px 20px;
            opacity: 0.3;
        }
        
        .camera-frame {
            width: 280px;
            height: 280px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-lg);
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .camera-frame::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(106, 17, 203, 0.5) 0%,
                rgba(37, 117, 252, 0.5) 50%,
                rgba(15, 184, 142, 0.5) 100%);
            animation: cameraScan 3s infinite linear;
        }
        
        @keyframes cameraScan {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }
        
        .camera-controls {
            padding: var(--spacing-xl);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--spacing-xl);
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: var(--glass-blur);
        }
        
        .shutter-btn {
            width: 76px;
            height: 76px;
            border-radius: var(--radius-full);
            background: rgba(255, 255, 255, 0.95);
            border: 4px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
        }
        
        .shutter-btn::before {
            content: '';
            position: absolute;
            top: 4px;
            left: 4px;
            right: 4px;
            bottom: 4px;
            border-radius: var(--radius-full);
            background: rgba(0, 0, 0, 0.1);
        }
        
        .shutter-btn:active {
            transform: scale(0.92);
            background: rgba(255, 255, 255, 0.8);
        }
        
        /* Приложение Gallery */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            height: 100%;
            overflow-y: auto;
        }
        
        .gallery-item {
            aspect-ratio: 1;
            border-radius: var(--radius-md);
            overflow: hidden;
            position: relative;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .gallery-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, var(--photo-color1), var(--photo-color2));
            animation: photoGlow 2s infinite alternate;
        }
        
        @keyframes photoGlow {
            0% { filter: brightness(1); }
            100% { filter: brightness(1.1); }
        }
        
        .gallery-item::after {
            content: attr(data-time);
            position: absolute;
            bottom: 4px;
            right: 4px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        /* Приложение Music */
        .music-player {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: var(--spacing-xl);
            background: rgba(0, 0, 0, 0.5);
        }
        
        .album-art {
            width: 220px;
            height: 220px;
            border-radius: var(--radius-lg);
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            margin: 0 auto var(--spacing-xl);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .album-art::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, transparent 45%, rgba(255,255,255,0.1) 50%, transparent 55%),
                linear-gradient(-45deg, transparent 45%, rgba(255,255,255,0.1) 50%, transparent 55%);
            animation: rotate 20s infinite linear;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .track-info {
            text-align: center;
            margin-bottom: var(--spacing-xl);
            color: white;
        }
        
        .track-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }
        
        .track-artist {
            font-size: 16px;
            opacity: 0.8;
        }
        
        .progress-container {
            margin-bottom: var(--spacing-xl);
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-full);
            margin-bottom: var(--spacing-sm);
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            width: 45%;
            background: var(--gradient-primary);
            border-radius: var(--radius-full);
            position: relative;
            transition: width 0.1s linear;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: white;
            border-radius: var(--radius-full);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            opacity: 0.7;
            color: white;
        }
        
        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--spacing-xl);
            padding: var(--spacing-xl) 0;
        }
        
        .control-btn {
            width: 56px;
            height: 56px;
            border-radius: var(--radius-full);
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all var(--transition-fast);
            color: white;
            font-size: 20px;
        }
        
        .control-btn.play {
            width: 72px;
            height: 72px;
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 8px 32px rgba(106, 17, 203, 0.4);
        }
        
        .control-btn:active {
            transform: scale(0.92);
        }
        
        /* Приложение Notes */
        .notes-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            height: 100%;
            overflow-y: auto;
        }
        
        .note-item {
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            border-left: 4px solid hsl(var(--color-primary));
            cursor: pointer;
            transition: all var(--transition-fast);
            border: 1px solid rgba(255, 255, 255, 0.05);
            color: white;
        }
        
        .note-item:active {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .note-title {
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .note-preview {
            font-size: 14px;
            opacity: 0.8;
            line-height: 1.4;
        }
        
        .note-editor {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .note-title-input {
            padding: var(--spacing-lg);
            font-size: 20px;
            font-weight: 600;
            background: transparent;
            border: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            margin-bottom: var(--spacing-md);
            color: white;
            outline: none;
        }
        
        .note-title-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .note-content-input {
            flex: 1;
            padding: var(--spacing-lg);
            background: transparent;
            border: none;
            font-size: 16px;
            line-height: 1.6;
            color: white;
            resize: none;
            outline: none;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        }
        
        .note-content-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .note-toolbar {
            padding: var(--spacing-md);
            display: flex;
            gap: var(--spacing-md);
            background: rgba(255, 255, 255, 0.05);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        /* Приложение Settings */
        .settings-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            height: 100%;
            overflow-y: auto;
        }
        
        .setting-item {
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            cursor: pointer;
            transition: all var(--transition-fast);
            border: 1px solid rgba(255, 255, 255, 0.05);
            color: white;
        }
        
        .setting-item:active {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .setting-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            color: hsl(var(--color-primary));
            font-size: 20px;
        }
        
        .theme-selector {
            display: flex;
            gap: var(--spacing-md);
            margin-top: var(--spacing-md);
        }
        
        .theme-option {
            flex: 1;
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            background: rgba(255, 255, 255, 0.05);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-fast);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .theme-option.active {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .color-options {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            margin-top: var(--spacing-md);
        }
        
        .color-option {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            cursor: pointer;
            transition: transform var(--transition-fast);
            border: 2px solid transparent;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .color-option.active {
            border-color: white;
            transform: scale(1.1);
            box-shadow: 0 0 20px currentColor;
        }
        
        /* Приложение Clock */
        .clock-container {
            padding: var(--spacing-xl);
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .clock-face {
            text-align: center;
            padding: var(--spacing-xl);
            font-size: 72px;
            font-weight: 200;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            margin: var(--spacing-xl) 0;
            box-shadow: var(--shadow-md);
            color: white;
            font-feature-settings: "tnum";
            letter-spacing: -4px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .alarm-list {
            width: 100%;
            max-width: 300px;
            margin-top: var(--spacing-xl);
        }
        
        .alarm-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-sm);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .timer-controls {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
            margin-top: var(--spacing-xl);
        }
        
        .timer-btn {
            padding: var(--spacing-md) var(--spacing-xl);
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: var(--radius-full);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .timer-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Приложение Weather */
        .weather-container {
            padding: var(--spacing-xl);
            height: 100%;
            background: linear-gradient(135deg, #1a2980, #26d0ce);
            color: white;
        }
        
        .weather-current {
            text-align: center;
            padding: var(--spacing-xl);
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-xl);
            backdrop-filter: var(--glass-blur);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .weather-temp {
            font-size: 72px;
            font-weight: 200;
            margin: var(--spacing-md) 0;
            letter-spacing: -4px;
        }
        
        .weather-condition {
            font-size: 20px;
            opacity: 0.9;
        }
        
        .weather-location {
            font-size: 16px;
            opacity: 0.8;
            margin-top: var(--spacing-sm);
        }
        
        .weather-forecast {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-sm);
        }
        
        .forecast-day {
            flex: 1;
            text-align: center;
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            backdrop-filter: var(--glass-blur);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Приложение Files */
        .files-container {
            padding: var(--spacing-md);
            height: 100%;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .file-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }
        
        .file-item {
            display: flex;
            align-items: center;
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            gap: var(--spacing-md);
            border: 1px solid rgba(255, 255, 255, 0.05);
            color: white;
        }
        
        .file-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            color: hsl(var(--color-primary));
            font-size: 20px;
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-name {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .file-size {
            font-size: 12px;
            opacity: 0.7;
        }
        
        /* Приложение Calculator */
        .calculator {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
        }
        
        .calculator-display {
            padding: var(--spacing-xl);
            text-align: right;
            font-size: 56px;
            font-weight: 300;
            min-height: 140px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: white;
            font-feature-settings: "tnum";
            letter-spacing: -2px;
            overflow: hidden;
        }
        
        .calculator-buttons {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .calc-btn {
            background: rgba(255, 255, 255, 0.08);
            border: none;
            font-size: 24px;
            cursor: pointer;
            transition: all var(--transition-fast);
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .calc-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity var(--transition-fast);
        }
        
        .calc-btn:active::before {
            opacity: 1;
        }
        
        .calc-btn.operation {
            background: rgba(255, 255, 255, 0.12);
            color: hsl(var(--color-primary));
        }
        
        .calc-btn.equals {
            background: var(--gradient-primary);
            color: white;
        }
        
        /* Приложение Browser */
        .browser-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            background: white;
        }
        
        .browser-header {
            padding: var(--spacing-md);
            background: var(--gradient-primary);
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }
        
        .browser-url-bar {
            flex: 1;
            padding: var(--spacing-sm) var(--spacing-md);
            background: rgba(255, 255, 255, 0.9);
            border-radius: var(--radius-full);
            border: none;
            font-size: 14px;
            outline: none;
        }
        
        .browser-content {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-md);
            background: white;
            color: #333;
        }
        
        .browser-page {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .browser-page h1 {
            font-size: 24px;
            margin-bottom: var(--spacing-md);
            color: #333;
        }
        
        .browser-page p {
            line-height: 1.6;
            margin-bottom: var(--spacing-md);
            color: #666;
        }
        
        /* Уведомления */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0, 0, 0, 0.8);
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--radius-full);
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            opacity: 0;
            transition: all var(--transition-spring);
            color: white;
            backdrop-filter: var(--glass-blur);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        /* Симуляция виброотклика */
        .vibrate {
            animation: vibrate 100ms linear;
        }
        
        @keyframes vibrate {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-1px); }
            75% { transform: translateX(1px); }
        }
        
        /* Скрытие скроллбара */
        ::-webkit-scrollbar {
            display: none;
        }
        
        * {
            scrollbar-width: none;
        }
        
        /* Доступность */
        button:focus-visible, .app-icon:focus-visible {
            outline: 2px solid hsl(var(--color-primary));
            outline-offset: 2px;
        }
        
        input:focus, textarea:focus {
            outline: 2px solid hsl(var(--color-primary));
            outline-offset: -2px;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="phone-container">
            <!-- Обои -->
            <div class="wallpaper"></div>
            
            <!-- Статус бар -->
            <div class="status-bar">
                <div class="status-left">
                    <span id="time">9:41</span>
                </div>
                <div class="status-right">
                    <span class="signal">📶</span>
                    <span class="wifi">📡</span>
                    <div class="battery"></div>
                </div>
            </div>
            
            <!-- Экран блокировки -->
            <div class="lockscreen" id="lockscreen">
                <div class="lockscreen-top">
                    <span id="lock-date">Пн, 1 янв</span>
                    <span id="lock-time">9:41</span>
                </div>
                <div class="lockscreen-time" id="lockscreen-time">9:41</div>
                <div class="lockscreen-date" id="lockscreen-date">Понедельник, 1 января</div>
                <div class="unlock-hint">
                    <div class="unlock-handle" id="unlockHandle">
                        <div class="unlock-arrow">↑</div>
                    </div>
                    <span>Потяните для разблокировки</span>
                    <div class="unlock-progress">
                        <div class="unlock-progress-bar" id="unlockProgress"></div>
                    </div>
                </div>
            </div>
            
            <!-- Домашний экран -->
            <div class="home-screen" id="homeScreen">
                <div class="app-grid" id="appGrid">
                    <!-- Приложения будут сгенерированы через JS -->
                </div>
                <div class="dock" id="dock">
                    <!-- Док-приложения будут сгенерированы через JS -->
                </div>
            </div>
            
            <!-- Шторка уведомлений -->
            <div class="notification-shade" id="notificationShade">
                <div class="quick-settings" id="quickSettings">
                    <!-- Быстрые настройки будут сгенерированы через JS -->
                </div>
                <div class="notification-list" id="notificationList">
                    <!-- Уведомления будут сгенерированы через JS -->
                </div>
            </div>
            
            <!-- Экран приложения -->
            <div id="appScreenContainer"></div>
            
            <!-- Всплывающее уведомление -->
            <div class="toast" id="toast">
                <span id="toast-icon">📱</span>
                <span id="toast-text">Уведомление</span>
            </div>
        </div>
    </div>

    <script>
        // Основной модуль alimOS
        (function() {
            'use strict';
            
            // Конфигурация системы
            const alimOS = {
                version: '1.2.0',
                name: 'alimOS',
                apps: [],
                state: {
                    locked: true,
                    activeApp: null,
                    theme: 'dark',
                    accentColor: '220, 90%, 56%',
                    brightness: 100,
                    sound: true,
                    wifi: true,
                    bluetooth: false,
                    battery: 85
                },
                data: {
                    notes: [],
                    photos: [],
                    calls: [],
                    messages: [],
                    alarms: [],
                    settings: {}
                }
            };
            
            // SVG иконки
            const icons = {
                phone: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>`,
                messages: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/></svg>`,
                camera: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>`,
                gallery: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>`,
                music: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>`,
                notes: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>`,
                settings: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>`,
                clock: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>`,
                weather: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>`,
                files: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>`,
                calculator: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-2h2v2zm0-4H7v-2h2v2zm0-4H7V7h2v2zm4 8h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V7h2v2zm4 8h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>`,
                browser: `<svg class="icon-svg" viewBox="0 0 24 24"><path fill="white" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H4v-4h11v4zm0-5H4V9h11v4zm5 5h-4V9h4v9z"/></svg>`
            };
            
            // Инициализация
            document.addEventListener('DOMContentLoaded', function() {
                // Инициализация DOM элементов
                const elements = {
                    lockscreen: document.getElementById('lockscreen'),
                    homeScreen: document.getElementById('homeScreen'),
                    notificationShade: document.getElementById('notificationShade'),
                    appGrid: document.getElementById('appGrid'),
                    dock: document.getElementById('dock'),
                    appScreenContainer: document.getElementById('appScreenContainer'),
                    toast: document.getElementById('toast'),
                    toastIcon: document.getElementById('toast-icon'),
                    toastText: document.getElementById('toast-text'),
                    time: document.getElementById('time'),
                    lockTime: document.getElementById('lock-time'),
                    lockDate: document.getElementById('lock-date'),
                    lockscreenTime: document.getElementById('lockscreen-time'),
                    lockscreenDate: document.getElementById('lockscreen-date'),
                    quickSettings: document.getElementById('quickSettings'),
                    notificationList: document.getElementById('notificationList'),
                    unlockHandle: document.getElementById('unlockHandle'),
                    unlockProgress: document.getElementById('unlockProgress')
                };
                
                // Состояние жестов
                let touchStartY = 0;
                let touchStartX = 0;
                let isDragging = false;
                let isUnlocking = false;
                let unlockProgress = 0;
                let currentScreen = 'lockscreen';
                let notificationShadeStartY = 0;
                let isNotificationShadeDragging = false;
                
                // Инициализация приложений
                initApps();
                initDemoData();
                initQuickSettings();
                initNotifications();
                updateTime();
                setInterval(updateTime, 1000);
                
                // Загрузка данных из localStorage
                loadFromStorage();
                
                // Применение сохранённой темы
                applyTheme();
                
                // Жесты для разблокировки
                elements.unlockHandle.addEventListener('touchstart', handleUnlockStart, {passive: true});
                elements.unlockHandle.addEventListener('mousedown', handleUnlockStart);
                document.addEventListener('touchmove', handleUnlockMove, {passive: true});
                document.addEventListener('mousemove', handleUnlockMove);
                document.addEventListener('touchend', handleUnlockEnd);
                document.addEventListener('mouseup', handleUnlockEnd);
                
                // Жесты для шторки уведомлений
                document.addEventListener('touchstart', handleNotificationShadeStart, {passive: true});
                document.addEventListener('mousedown', handleNotificationShadeStart);
                document.addEventListener('touchmove', handleNotificationShadeMove, {passive: true});
                document.addEventListener('mousemove', handleNotificationShadeMove);
                document.addEventListener('touchend', handleNotificationShadeEnd);
                document.addEventListener('mouseup', handleNotificationShadeEnd);
                
                // Функции обработки жестов разблокировки
                function handleUnlockStart(e) {
                    if (currentScreen !== 'lockscreen') return;
                    
                    const touchY = e.touches ? e.touches[0].clientY : e.clientY;
                    touchStartY = touchY;
                    isDragging = true;
                    isUnlocking = true;
                    
                    if (e.type === 'mousedown') {
                        e.preventDefault();
                    }
                }
                
                function handleUnlockMove(e) {
                    if (!isDragging || !isUnlocking) return;
                    
                    const touchY = e.touches ? e.touches[0].clientY : e.clientY;
                    const deltaY = touchStartY - touchY;
                    
                    if (deltaY > 0) {
                        unlockProgress = Math.min(deltaY / 200, 1);
                        elements.lockscreen.style.transform = `translateY(-${unlockProgress * 100}%)`;
                        elements.lockscreen.style.opacity = 1 - unlockProgress;
                        elements.unlockProgress.style.width = `${unlockProgress * 100}%`;
                        
                        // Анимация ручки
                        elements.unlockHandle.style.transform = `translateY(-${unlockProgress * 60}px)`;
                        elements.unlockHandle.style.opacity = 1 - unlockProgress * 0.5;
                    }
                    
                    if (e.type === 'mousemove') {
                        e.preventDefault();
                    }
                }
                
                function handleUnlockEnd(e) {
                    if (!isDragging || !isUnlocking) return;
                    
                    if (unlockProgress > 0.5) {
                        unlockDevice();
                    } else {
                        resetUnlock();
                    }
                    
                    isDragging = false;
                    isUnlocking = false;
                    
                    if (e.type === 'mouseup') {
                        e.preventDefault();
                    }
                }
                
                function resetUnlock() {
                    unlockProgress = 0;
                    elements.lockscreen.style.transform = 'translateY(0)';
                    elements.lockscreen.style.opacity = '1';
                    elements.unlockProgress.style.width = '0%';
                    elements.unlockHandle.style.transform = 'translateY(0)';
                    elements.unlockHandle.style.opacity = '1';
                }
                
                // Функции обработки жестов шторки
                function handleNotificationShadeStart(e) {
                    if (currentScreen !== 'home' && currentScreen !== 'notification') return;
                    
                    const touchY = e.touches ? e.touches[0].clientY : e.clientY;
                    
                    // Если касание в верхней части экрана
                    if (touchY < 100) {
                        notificationShadeStartY = touchY;
                        isNotificationShadeDragging = true;
                        
                        if (currentScreen === 'home') {
                            elements.notificationShade.style.transition = 'none';
                        }
                    }
                    
                    if (e.type === 'mousedown') {
                        e.preventDefault();
                    }
                }
                
                function handleNotificationShadeMove(e) {
                    if (!isNotificationShadeDragging) return;
                    
                    const touchY = e.touches ? e.touches[0].clientY : e.clientY;
                    const deltaY = touchY - notificationShadeStartY;
                    
                    if (currentScreen === 'home' && deltaY > 0) {
                        const progress = Math.min(deltaY / 400, 1);
                        elements.notificationShade.style.transform = `translateY(${progress * 100 - 100}%)`;
                    } else if (currentScreen === 'notification' && deltaY < 0) {
                        const progress = Math.min(-deltaY / 400, 1);
                        elements.notificationShade.style.transform = `translateY(${100 - progress * 100}%)`;
                    }
                    
                    if (e.type === 'mousemove') {
                        e.preventDefault();
                    }
                }
                
                function handleNotificationShadeEnd(e) {
                    if (!isNotificationShadeDragging) return;
                    
                    const touchY = e.changedTouches ? e.changedTouches[0].clientY : e.clientY;
                    const deltaY = touchY - notificationShadeStartY;
                    
                    elements.notificationShade.style.transition = 'transform var(--transition-spring)';
                    
                    if (currentScreen === 'home' && deltaY > 100) {
                        openNotificationShade();
                    } else if (currentScreen === 'notification' && deltaY < -100) {
                        closeNotificationShade();
                    } else {
                        // Возврат в исходное положение
                        if (currentScreen === 'home') {
                            elements.notificationShade.style.transform = 'translateY(-100%)';
                        } else {
                            elements.notificationShade.style.transform = 'translateY(100%)';
                        }
                    }
                    
                    isNotificationShadeDragging = false;
                    
                    if (e.type === 'mouseup') {
                        e.preventDefault();
                    }
                }
                
                function unlockDevice() {
                    elements.lockscreen.classList.add('hidden');
                    elements.homeScreen.classList.remove('hidden');
                    alimOS.state.locked = false;
                    currentScreen = 'home';
                    vibrate();
                    showToast('Разблокировано', '🔓');
                }
                
                function lockDevice() {
                    elements.lockscreen.classList.remove('hidden');
                    elements.homeScreen.classList.add('hidden');
                    alimOS.state.locked = true;
                    currentScreen = 'lockscreen';
                    resetUnlock();
                }
                
                function openNotificationShade() {
                    elements.notificationShade.classList.add('open');
                    currentScreen = 'notification';
                    vibrate();
                }
                
                function closeNotificationShade() {
                    elements.notificationShade.classList.remove('open');
                    currentScreen = 'home';
                }
                
                // Обновление времени
                function updateTime() {
                    const now = new Date();
                    const timeStr = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'});
                    const timeFullStr = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit', second: '2-digit'});
                    const dateStr = now.toLocaleDateString('ru-RU', {weekday: 'short', day: 'numeric', month: 'short'});
                    const fullDateStr = now.toLocaleDateString('ru-RU', {weekday: 'long', day: 'numeric', month: 'long'});
                    
                    elements.time.textContent = timeStr;
                    elements.lockTime.textContent = timeStr;
                    elements.lockscreenTime.textContent = timeFullStr;
                    elements.lockDate.textContent = dateStr;
                    elements.lockscreenDate.textContent = fullDateStr;
                }
                
                // Симуляция вибрации
                function vibrate() {
                    document.body.classList.add('vibrate');
                    setTimeout(() => {
                        document.body.classList.remove('vibrate');
                    }, 100);
                }
                
                // Показ уведомления
                function showToast(message, icon = '📱') {
                    elements.toastIcon.textContent = icon;
                    elements.toastText.textContent = message;
                    elements.toast.classList.add('show');
                    
                    setTimeout(() => {
                        elements.toast.classList.remove('show');
                    }, 3000);
                }
                
                // Инициализация приложений
                function initApps() {
                    const apps = [
                        {
                            id: 'phone',
                            name: 'Телефон',
                            icon: icons.phone,
                            color: '#10b981',
                            dock: true
                        },
                        {
                            id: 'messages',
                            name: 'Сообщения',
                            icon: icons.messages,
                            color: '#3b82f6',
                            dock: true
                        },
                        {
                            id: 'camera',
                            name: 'Камера',
                            icon: icons.camera,
                            color: '#ef4444',
                            dock: false
                        },
                        {
                            id: 'gallery',
                            name: 'Галерея',
                            icon: icons.gallery,
                            color: '#8b5cf6',
                            dock: false
                        },
                        {
                            id: 'music',
                            name: 'Музыка',
                            icon: icons.music,
                            color: '#f59e0b',
                            dock: false
                        },
                        {
                            id: 'notes',
                            name: 'Заметки',
                            icon: icons.notes,
                            color: '#06b6d4',
                            dock: false
                        },
                        {
                            id: 'settings',
                            name: 'Настройки',
                            icon: icons.settings,
                            color: '#6b7280',
                            dock: true
                        },
                        {
                            id: 'clock',
                            name: 'Часы',
                            icon: icons.clock,
                            color: '#f97316',
                            dock: false
                        },
                        {
                            id: 'weather',
                            name: 'Погода',
                            icon: icons.weather,
                            color: '#0ea5e9',
                            dock: false
                        },
                        {
                            id: 'files',
                            name: 'Файлы',
                            icon: icons.files,
                            color: '#84cc16',
                            dock: false
                        },
                        {
                            id: 'calculator',
                            name: 'Калькулятор',
                            icon: icons.calculator,
                            color: '#ec4899',
                            dock: false
                        },
                        {
                            id: 'browser',
                            name: 'Браузер',
                            icon: icons.browser,
                            color: '#6366f1',
                            dock: true
                        }
                    ];
                    
                    alimOS.apps = apps;
                    
                    // Генерация иконок приложений
                    apps.forEach(app => {
                        const appElement = document.createElement('div');
                        appElement.className = 'app-icon';
                        appElement.tabIndex = 0;
                        appElement.setAttribute('role', 'button');
                        appElement.setAttribute('aria-label', `Открыть ${app.name}`);
                        appElement.innerHTML = `
                            <div class="app-icon-wrapper">${app.icon}</div>
                            <div class="app-name">${app.name}</div>
                        `;
                        
                        appElement.addEventListener('click', () => openApp(app.id));
                        appElement.addEventListener('keypress', (e) => {
                            if (e.key === 'Enter' || e.key === ' ') {
                                openApp(app.id);
                            }
                        });
                        
                        elements.appGrid.appendChild(appElement);
                        
                        // Добавление в док, если нужно
                        if (app.dock) {
                            const dockApp = appElement.cloneNode(true);
                            dockApp.addEventListener('click', () => openApp(app.id));
                            dockApp.addEventListener('keypress', (e) => {
                                if (e.key === 'Enter' || e.key === ' ') {
                                    openApp(app.id);
                                }
                            });
                            elements.dock.appendChild(dockApp);
                        }
                    });
                }
                
                // Открытие приложения
                function openApp(appId) {
                    if (alimOS.state.locked) return;
                    
                    const app = alimOS.apps.find(a => a.id === appId);
                    if (!app) return;
                    
                    currentScreen = 'app';
                    alimOS.state.activeApp = appId;
                    
                    // Закрытие шторки, если открыта
                    closeNotificationShade();
                    
                    // Создание экрана приложения
                    elements.appScreenContainer.innerHTML = '';
                    const appScreen = document.createElement('div');
                    appScreen.className = 'app-screen';
                    appScreen.id = `app-${appId}`;
                    
                    // Заголовок приложения
                    const appHeader = document.createElement('div');
                    appHeader.className = 'app-header';
                    appHeader.innerHTML = `
                        <button class="btn-back" aria-label="Назад" onclick="window.closeApp()">←</button>
                        <div class="app-title">${app.name}</div>
                        <div style="width: 36px;"></div>
                    `;
                    
                    appScreen.appendChild(appHeader);
                    
                    // Контент приложения
                    const appContent = document.createElement('div');
                    appContent.className = 'app-content';
                    
                    // Генерация контента в зависимости от приложения
                    switch(appId) {
                        case 'phone':
                            generatePhoneApp(appContent);
                            break;
                        case 'messages':
                            generateMessagesApp(appContent);
                            break;
                        case 'camera':
                            generateCameraApp(appContent);
                            break;
                        case 'gallery':
                            generateGalleryApp(appContent);
                            break;
                        case 'music':
                            generateMusicApp(appContent);
                            break;
                        case 'notes':
                            generateNotesApp(appContent);
                            break;
                        case 'settings':
                            generateSettingsApp(appContent);
                            break;
                        case 'clock':
                            generateClockApp(appContent);
                            break;
                        case 'weather':
                            generateWeatherApp(appContent);
                            break;
                        case 'files':
                            generateFilesApp(appContent);
                            break;
                        case 'calculator':
                            generateCalculatorApp(appContent);
                            break;
                        case 'browser':
                            generateBrowserApp(appContent);
                            break;
                    }
                    
                    appScreen.appendChild(appContent);
                    elements.appScreenContainer.appendChild(appScreen);
                    
                    // Анимация открытия
                    setTimeout(() => {
                        appScreen.classList.add('open');
                    }, 10);
                    
                    vibrate();
                }
                
                // Закрытие приложения
                window.closeApp = function() {
                    const activeApp = document.querySelector('.app-screen.open');
                    if (activeApp) {
                        activeApp.classList.remove('open');
                        setTimeout(() => {
                            elements.appScreenContainer.innerHTML = '';
                            currentScreen = 'home';
                            alimOS.state.activeApp = null;
                        }, 300);
                    }
                    vibrate();
                };
                
                // Генератор приложения Phone
                function generatePhoneApp(container) {
                    container.innerHTML = `
                        <div class="dialer">
                            <div class="dialer-display" id="dialerDisplay"></div>
                            <div class="dialer-pad">
                                <div class="dialer-btn" onclick="dialNumber('1')"><span>1</span><span class="dialer-btn-sub"></span></div>
                                <div class="dialer-btn" onclick="dialNumber('2')"><span>2</span><span class="dialer-btn-sub">ABC</span></div>
                                <div class="dialer-btn" onclick="dialNumber('3')"><span>3</span><span class="dialer-btn-sub">DEF</span></div>
                                <div class="dialer-btn" onclick="dialNumber('4')"><span>4</span><span class="dialer-btn-sub">GHI</span></div>
                                <div class="dialer-btn" onclick="dialNumber('5')"><span>5</span><span class="dialer-btn-sub">JKL</span></div>
                                <div class="dialer-btn" onclick="dialNumber('6')"><span>6</span><span class="dialer-btn-sub">MNO</span></div>
                                <div class="dialer-btn" onclick="dialNumber('7')"><span>7</span><span class="dialer-btn-sub">PQRS</span></div>
                                <div class="dialer-btn" onclick="dialNumber('8')"><span>8</span><span class="dialer-btn-sub">TUV</span></div>
                                <div class="dialer-btn" onclick="dialNumber('9')"><span>9</span><span class="dialer-btn-sub">WXYZ</span></div>
                                <div class="dialer-btn" onclick="dialNumber('*')"><span>*</span></div>
                                <div class="dialer-btn" onclick="dialNumber('0')"><span>0</span><span class="dialer-btn-sub">+</span></div>
                                <div class="dialer-btn" onclick="dialNumber('#')"><span>#</span></div>
                            </div>
                            <div style="padding: var(--spacing-lg); display: flex; gap: var(--spacing-md);">
                                <button style="flex:1; padding: var(--spacing-md); background: var(--gradient-primary); color: white; border: none; border-radius: var(--radius-full); font-weight: 600;" onclick="makeCall()">Вызов</button>
                                <button style="width: 56px; padding: var(--spacing-md); background: #ef4444; color: white; border: none; border-radius: var(--radius-full); font-weight: 600;" onclick="clearDialer()">⌫</button>
                            </div>
                        </div>
                    `;
                }
                
                // Функции для приложения Phone
                window.dialNumber = function(number) {
                    const display = document.getElementById('dialerDisplay');
                    display.textContent = (display.textContent + number).slice(-15);
                    vibrate();
                };
                
                window.clearDialer = function() {
                    const display = document.getElementById('dialerDisplay');
                    display.textContent = display.textContent.slice(0, -1);
                    vibrate();
                };
                
                window.makeCall = function() {
                    const display = document.getElementById('dialerDisplay');
                    if (display.textContent.trim() === '') return;
                    
                    showToast(`Вызов: ${display.textContent}`, '📞');
                    
                    // Сохранение в историю
                    alimOS.data.calls.unshift({
                        number: display.textContent,
                        time: new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'}),
                        type: 'outgoing'
                    });
                    
                    saveToStorage();
                    display.textContent = '';
                    vibrate();
                };
                
                // Генератор приложения Messages
                function generateMessagesApp(container) {
                    const chats = alimOS.data.messages || [];
                    
                    if (chats.length === 0) {
                        container.innerHTML = `
                            <div class="chat-list">
                                <div class="chat-item" onclick="openChat('alim')">
                                    <div class="chat-avatar">A</div>
                                    <div class="chat-content">
                                        <div class="chat-name">Поддержка alimOS</div>
                                        <div class="chat-preview">Добро пожаловать в alimOS!</div>
                                    </div>
                                </div>
                                <div class="chat-item" onclick="openChat('eva')">
                                    <div class="chat-avatar">E</div>
                                    <div class="chat-content">
                                        <div class="chat-name">Eva</div>
                                        <div class="chat-preview">Как тебе новая ОС?</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    } else {
                        let html = '<div class="chat-list">';
                        chats.forEach(chat => {
                            html += `
                                <div class="chat-item" onclick="openChat('${chat.id}')">
                                    <div class="chat-avatar">${chat.name.charAt(0)}</div>
                                    <div class="chat-content">
                                        <div class="chat-name">${chat.name}</div>
                                        <div class="chat-preview">${chat.messages[chat.messages.length - 1]?.text || 'Нет сообщений'}</div>
                                    </div>
                                </div>
                            `;
                        });
                        html += '</div>';
                        container.innerHTML = html;
                    }
                }
                
                // Функции для приложения Messages
                window.openChat = function(chatId) {
                    const container = document.querySelector('.app-content');
                    
                    let chatData;
                    if (chatId === 'alim') {
                        chatData = {
                            id: 'alim',
                            name: 'Поддержка alimOS',
                            messages: [
                                {text: 'Добро пожаловать в alimOS!', incoming: true, time: '10:00'},
                                {text: 'Это сообщение демонстрирует работу чата.', incoming: true, time: '10:01'},
                                {text: 'Вы можете отвечать на сообщения.', incoming: false, time: '10:05'}
                            ]
                        };
                    } else if (chatId === 'eva') {
                        chatData = {
                            id: 'eva',
                            name: 'Eva',
                            messages: [
                                {text: 'Привет! Как тебе новая ОС?', incoming: true, time: '09:30'},
                                {text: 'Мне очень нравится дизайн!', incoming: false, time: '09:35'},
                                {text: 'Да, он действительно уникальный. Жду твоего фидбека!', incoming: true, time: '09:40'}
                            ]
                        };
                    } else {
                        chatData = alimOS.data.messages.find(c => c.id === chatId);
                    }
                    
                    if (!chatData) return;
                    
                    let messagesHtml = `
                        <div class="chat-conversation" id="chatConversation">
                    `;
                    
                    chatData.messages.forEach(msg => {
                        messagesHtml += `
                            <div class="message ${msg.incoming ? 'message-incoming' : 'message-outgoing'}">
                                <div>${msg.text}</div>
                                <div style="font-size: 12px; opacity: 0.7; text-align: right; margin-top: 4px;">${msg.time}</div>
                            </div>
                        `;
                    });
                    
                    messagesHtml += `
                        </div>
                        <div class="message-input-container">
                            <div class="message-input-wrapper">
                                <input type="text" class="message-input" id="messageInput" placeholder="Сообщение..." autocomplete="off">
                                <button class="send-button" onclick="sendMessage('${chatId}')">→</button>
                            </div>
                        </div>
                    `;
                    
                    container.innerHTML = `
                        <div style="display: flex; align-items: center; gap: var(--spacing-md); padding: var(--spacing-md); border-bottom: 1px solid rgba(255, 255, 255, 0.05);">
                            <button class="btn-back" onclick="closeChat()">←</button>
                            <div style="font-weight: 600; color: white;">${chatData.name}</div>
                        </div>
                        ${messagesHtml}
                    `;
                    
                    // Прокрутка вниз
                    setTimeout(() => {
                        const conversation = document.getElementById('chatConversation');
                        if (conversation) {
                            conversation.scrollTop = conversation.scrollHeight;
                        }
                        document.getElementById('messageInput').focus();
                    }, 100);
                };
                
                window.closeChat = function() {
                    generateMessagesApp(document.querySelector('.app-content'));
                };
                
                window.sendMessage = function(chatId) {
                    const input = document.getElementById('messageInput');
                    const text = input.value.trim();
                    if (!text) return;
                    
                    const time = new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'});
                    
                    // Добавляем сообщение пользователя
                    const conversation = document.getElementById('chatConversation');
                    if (conversation) {
                        const messageDiv = document.createElement('div');
                        messageDiv.className = 'message message-outgoing';
                        messageDiv.innerHTML = `
                            <div>${text}</div>
                            <div style="font-size: 12px; opacity: 0.7; text-align: right; margin-top: 4px;">${time}</div>
                        `;
                        conversation.appendChild(messageDiv);
                        conversation.scrollTop = conversation.scrollHeight;
                    }
                    
                    // Очищаем поле ввода
                    input.value = '';
                    input.focus();
                    
                    // Добавляем автоматический ответ через 1 секунду
                    setTimeout(() => {
                        const responses = [
                            'Интересно!',
                            'Продолжайте тестировать alimOS!',
                            'Спасибо за сообщение!',
                            'Отличная мысль!',
                            'Я передам это разработчикам.'
                        ];
                        const response = responses[Math.floor(Math.random() * responses.length)];
                        
                        if (conversation) {
                            const responseDiv = document.createElement('div');
                            responseDiv.className = 'message message-incoming';
                            responseDiv.innerHTML = `
                                <div>${response}</div>
                                <div style="font-size: 12px; opacity: 0.7; text-align: right; margin-top: 4px;">${new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'})}</div>
                            `;
                            conversation.appendChild(responseDiv);
                            conversation.scrollTop = conversation.scrollHeight;
                        }
                    }, 1000);
                    
                    vibrate();
                };
                
                // Генератор приложения Camera
                function generateCameraApp(container) {
                    container.innerHTML = `
                        <div class="camera-viewfinder">
                            <div class="camera-grid"></div>
                            <div class="camera-frame"></div>
                        </div>
                        <div class="camera-controls">
                            <div class="control-btn">🔄</div>
                            <div class="shutter-btn" onclick="takePhoto()"></div>
                            <div class="control-btn" onclick="openGalleryFromCamera()">🖼️</div>
                        </div>
                    `;
                }
                
                window.takePhoto = function() {
                    showToast('Фото сохранено в Галерею', '📸');
                    
                    // Добавляем фото в галерею
                    const colors = [
                        ['#667eea', '#764ba2'],
                        ['#f093fb', '#f5576c'],
                        ['#4facfe', '#00f2fe'],
                        ['#43e97b', '#38f9d7'],
                        ['#fa709a', '#fee140'],
                        ['#a8edea', '#fed6e3'],
                        ['#5ee7df', '#b490ca'],
                        ['#d299c2', '#fef9d7']
                    ];
                    
                    const randomColors = colors[Math.floor(Math.random() * colors.length)];
                    const photoId = 'photo_' + Date.now();
                    
                    alimOS.data.photos.unshift({
                        id: photoId,
                        color1: randomColors[0],
                        color2: randomColors[1],
                        time: new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'})
                    });
                    
                    saveToStorage();
                    vibrate();
                };
                
                window.openGalleryFromCamera = function() {
                    closeApp();
                    setTimeout(() => openApp('gallery'), 350);
                };
                
                // Генератор приложения Gallery
                function generateGalleryApp(container) {
                    const photos = alimOS.data.photos;
                    
                    if (photos.length === 0) {
                        // Добавляем демо фото
                        const colors = [
                            ['#667eea', '#764ba2'],
                            ['#f093fb', '#f5576c'],
                            ['#4facfe', '#00f2fe'],
                            ['#43e97b', '#38f9d7'],
                            ['#fa709a', '#fee140'],
                            ['#a8edea', '#fed6e3'],
                            ['#5ee7df', '#b490ca'],
                            ['#d299c2', '#fef9d7'],
                            ['#ffecd2', '#fcb69f']
                        ];
                        
                        colors.forEach((colorPair, i) => {
                            alimOS.data.photos.push({
                                id: 'demo_' + i,
                                color1: colorPair[0],
                                color2: colorPair[1],
                                time: `${10 + i}:${i % 2 === 0 ? '30' : '45'}`
                            });
                        });
                    }
                    
                    let html = '<div class="gallery-grid">';
                    alimOS.data.photos.forEach(photo => {
                        html += `
                            <div class="gallery-item" onclick="viewPhoto('${photo.id}')" 
                                 style="--photo-color1: ${photo.color1}; --photo-color2: ${photo.color2};"
                                 data-time="${photo.time}"></div>
                        `;
                    });
                    html += '</div>';
                    
                    container.innerHTML = html;
                }
                
                window.viewPhoto = function(photoId) {
                    const photo = alimOS.data.photos.find(p => p.id === photoId);
                    if (!photo) return;
                    
                    const container = document.querySelector('.app-content');
                    container.innerHTML = `
                        <div style="position: relative; height: 100%;">
                            <button class="btn-back" onclick="closePhotoView()" style="position: absolute; top: var(--spacing-md); left: var(--spacing-md); z-index: 1;">←</button>
                            <div style="width: 100%; height: 100%; background: linear-gradient(45deg, ${photo.color1}, ${photo.color2});"></div>
                            <div style="position: absolute; bottom: 0; left: 0; right: 0; padding: var(--spacing-xl); background: linear-gradient(to top, rgba(0,0,0,0.7), transparent); color: white;">
                                <div style="font-weight: 600; margin-bottom: var(--spacing-sm);">Фото</div>
                                <div style="opacity: 0.9;">Снято в ${photo.time}</div>
                            </div>
                        </div>
                    `;
                    
                    vibrate();
                };
                
                window.closePhotoView = function() {
                    generateGalleryApp(document.querySelector('.app-content'));
                };
                
                // Генератор приложения Music
                function generateMusicApp(container) {
                    container.innerHTML = `
                        <div class="music-player">
                            <div class="album-art"></div>
                            <div class="track-info">
                                <div class="track-title">Digital Sunrise</div>
                                <div class="track-artist">alimOS Sounds</div>
                            </div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="musicProgress"></div>
                                </div>
                                <div class="time-display">
                                    <span>2:15</span>
                                    <span>4:47</span>
                                </div>
                            </div>
                            <div class="player-controls">
                                <div class="control-btn">⏮️</div>
                                <div class="control-btn play" onclick="togglePlay()" id="playBtn">▶️</div>
                                <div class="control-btn">⏭️</div>
                            </div>
                        </div>
                    `;
                }
                
                let isPlaying = false;
                let progressInterval;
                
                window.togglePlay = function() {
                    const playBtn = document.getElementById('playBtn');
                    const progress = document.getElementById('musicProgress');
                    
                    if (!isPlaying) {
                        playBtn.innerHTML = '⏸️';
                        isPlaying = true;
                        
                        // Анимация прогресса
                        let width = 45;
                        progressInterval = setInterval(() => {
                            if (width >= 100) {
                                clearInterval(progressInterval);
                                playBtn.innerHTML = '▶️';
                                isPlaying = false;
                                progress.style.width = '45%';
                                return;
                            }
                            width += 0.5;
                            progress.style.width = width + '%';
                        }, 100);
                        showToast('Воспроизведение', '🎵');
                    } else {
                        playBtn.innerHTML = '▶️';
                        isPlaying = false;
                        clearInterval(progressInterval);
                        showToast('Пауза', '⏸️');
                    }
                    
                    vibrate();
                };
                
                // Генератор приложения Notes
                function generateNotesApp(container) {
                    const notes = alimOS.data.notes;
                    
                    if (notes.length === 0) {
                        container.innerHTML = `
                            <div class="notes-list">
                                <div class="note-item" onclick="editNote('demo1')">
                                    <div class="note-title">Добро пожаловать в alimOS</div>
                                    <div class="note-preview">Это ваша первая заметка. Нажмите, чтобы редактировать.</div>
                                </div>
                                <div class="note-item" onclick="editNote('demo2')">
                                    <div class="note-title">Идеи для приложений</div>
                                    <div class="note-preview">Подумать о новых функциях для ОС...</div>
                                </div>
                            </div>
                            <button style="position: fixed; bottom: var(--spacing-xl); right: var(--spacing-xl); width: 56px; height: 56px; border-radius: var(--radius-full); background: var(--gradient-primary); color: white; border: none; font-size: 24px; z-index: 10;" onclick="createNewNote()">+</button>
                        `;
                    } else {
                        let html = '<div class="notes-list">';
                        notes.forEach(note => {
                            html += `
                                <div class="note-item" onclick="editNote('${note.id}')">
                                    <div class="note-title">${note.title || 'Без названия'}</div>
                                    <div class="note-preview">${note.content.substring(0, 50)}${note.content.length > 50 ? '...' : ''}</div>
                                </div>
                            `;
                        });
                        html += `
                            </div>
                            <button style="position: fixed; bottom: var(--spacing-xl); right: var(--spacing-xl); width: 56px; height: 56px; border-radius: var(--radius-full); background: var(--gradient-primary); color: white; border: none; font-size: 24px; z-index: 10;" onclick="createNewNote()">+</button>
                        `;
                        container.innerHTML = html;
                    }
                }
                
                window.createNewNote = function() {
                    const noteId = 'note_' + Date.now();
                    alimOS.data.notes.unshift({
                        id: noteId,
                        title: '',
                        content: '',
                        created: new Date().toISOString()
                    });
                    
                    saveToStorage();
                    editNote(noteId);
                };
                
                window.editNote = function(noteId) {
                    let note = alimOS.data.notes.find(n => n.id === noteId);
                    
                    if (!note) {
                        note = {
                            id: noteId,
                            title: noteId === 'demo1' ? 'Добро пожаловать в alimOS' : 'Идеи для приложений',
                            content: noteId === 'demo1' ? 'Это ваша первая заметка. Нажмите, чтобы редактировать.\n\nalimOS предлагает чистый, минималистичный интерфейс с футуристичным дизайном.' : 'Подумать о новых функциях для ОС:\n1. Распознавание жестов\n2. ИИ-ассистент\n3. Умные виджеты\n4. Интеграция с IoT',
                            created: new Date().toISOString()
                        };
                        
                        if (!alimOS.data.notes.find(n => n.id === noteId)) {
                            alimOS.data.notes.unshift(note);
                        }
                    }
                    
                    const container = document.querySelector('.app-content');
                    container.innerHTML = `
                        <div class="note-editor">
                            <input type="text" class="note-title-input" id="noteTitle" value="${note.title}" placeholder="Название заметки">
                            <textarea class="note-content-input" id="noteContent" placeholder="Содержание заметки...">${note.content}</textarea>
                            <div class="note-toolbar">
                                <button class="btn-back" onclick="saveNote('${noteId}')" style="flex:1; padding: var(--spacing-md); background: var(--gradient-primary); color: white; border: none; border-radius: var(--radius-md); font-weight: 600;">Сохранить</button>
                            </div>
                        </div>
                    `;
                    
                    document.getElementById('noteTitle').focus();
                };
                
                window.saveNote = function(noteId) {
                    const title = document.getElementById('noteTitle').value;
                    const content = document.getElementById('noteContent').value;
                    
                    const noteIndex = alimOS.data.notes.findIndex(n => n.id === noteId);
                    if (noteIndex !== -1) {
                        alimOS.data.notes[noteIndex].title = title;
                        alimOS.data.notes[noteIndex].content = content;
                        alimOS.data.notes[noteIndex].updated = new Date().toISOString();
                    }
                    
                    saveToStorage();
                    generateNotesApp(document.querySelector('.app-content'));
                    showToast('Заметка сохранена', '📝');
                };
                
                // Генератор приложения Settings
                function generateSettingsApp(container) {
                    container.innerHTML = `
                        <div class="settings-list">
                            <div class="setting-item" onclick="openSetting('theme')">
                                <div class="setting-icon">🎨</div>
                                <div>
                                    <div style="font-weight: 600;">Тема и внешний вид</div>
                                    <div style="font-size: 14px; opacity: 0.8;">Светлая/Тёмная тема, акцентный цвет</div>
                                </div>
                            </div>
                            <div class="setting-item" onclick="openSetting('sound')">
                                <div class="setting-icon">🔊</div>
                                <div>
                                    <div style="font-weight: 600;">Звук и вибрация</div>
                                    <div style="font-size: 14px; opacity: 0.8;">Громкость, звуки системы</div>
                                </div>
                            </div>
                            <div class="setting-item" onclick="openSetting('display')">
                                <div class="setting-icon">🖥️</div>
                                <div>
                                    <div style="font-weight: 600;">Дисплей</div>
                                    <div style="font-size: 14px; opacity: 0.8;">Яркость, тайм-аут экрана</div>
                                </div>
                            </div>
                            <div class="setting-item" onclick="openSetting('about')">
                                <div class="setting-icon">ℹ️</div>
                                <div>
                                    <div style="font-weight: 600;">О системе</div>
                                    <div style="font-size: 14px; opacity: 0.8;">Версия alimOS, информация</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                window.openSetting = function(setting) {
                    const container = document.querySelector('.app-content');
                    
                    switch(setting) {
                        case 'theme':
                            container.innerHTML = `
                                <div style="padding: var(--spacing-lg); height: 100%; overflow-y: auto;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-md); margin-bottom: var(--spacing-xl);">
                                        <button class="btn-back" onclick="closeSetting()">←</button>
                                        <div style="font-weight: 600; color: white;">Тема и внешний вид</div>
                                    </div>
                                    
                                    <div style="margin-bottom: var(--spacing-xl);">
                                        <div style="margin-bottom: var(--spacing-md); font-weight: 600; color: white;">Тема</div>
                                        <div class="theme-selector">
                                            <div class="theme-option ${alimOS.state.theme === 'light' ? 'active' : ''}" onclick="setTheme('light')">
                                                <div>Светлая</div>
                                                <div style="font-size: 12px; opacity: 0.8;">☀️</div>
                                            </div>
                                            <div class="theme-option ${alimOS.state.theme === 'dark' ? 'active' : ''}" onclick="setTheme('dark')">
                                                <div>Тёмная</div>
                                                <div style="font-size: 12px; opacity: 0.8;">🌙</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div style="margin-bottom: var(--spacing-md); font-weight: 600; color: white;">Акцентный цвет</div>
                                        <div class="color-options">
                                            <div class="color-option ${alimOS.state.accentColor === '220, 90%, 56%' ? 'active' : ''}" style="background: hsl(220, 90%, 56%);" onclick="setAccentColor('220, 90%, 56%')"></div>
                                            <div class="color-option ${alimOS.state.accentColor === '280, 90%, 56%' ? 'active' : ''}" style="background: hsl(280, 90%, 56%);" onclick="setAccentColor('280, 90%, 56%')"></div>
                                            <div class="color-option ${alimOS.state.accentColor === '160, 90%, 45%' ? 'active' : ''}" style="background: hsl(160, 90%, 45%);" onclick="setAccentColor('160, 90%, 45%')"></div>
                                            <div class="color-option ${alimOS.state.accentColor === '40, 90%, 55%' ? 'active' : ''}" style="background: hsl(40, 90%, 55%);" onclick="setAccentColor('40, 90%, 55%')"></div>
                                            <div class="color-option ${alimOS.state.accentColor === '0, 90%, 58%' ? 'active' : ''}" style="background: hsl(0, 90%, 58%);" onclick="setAccentColor('0, 90%, 58%')"></div>
                                            <div class="color-option ${alimOS.state.accentColor === '10, 90%, 55%' ? 'active' : ''}" style="background: hsl(10, 90%, 55%);" onclick="setAccentColor('10, 90%, 55%')"></div>
                                        </div>
                                    </div>
                                </div>
                            `;
                            break;
                            
                        case 'about':
                            container.innerHTML = `
                                <div style="padding: var(--spacing-xl); height: 100%; overflow-y: auto; text-align: center;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-md); margin-bottom: var(--spacing-xl);">
                                        <button class="btn-back" onclick="closeSetting()">←</button>
                                        <div style="font-weight: 600; color: white;">О системе</div>
                                    </div>
                                    
                                    <div style="margin-bottom: var(--spacing-xl);">
                                        <div style="font-size: 48px; margin-bottom: var(--spacing-md);">📱</div>
                                        <div style="font-size: 28px; font-weight: 600; margin-bottom: var(--spacing-sm); color: white;">alimOS</div>
                                        <div style="opacity: 0.8; margin-bottom: var(--spacing-lg); color: rgba(255, 255, 255, 0.9);">Версия ${alimOS.version}</div>
                                        
                                        <div style="text-align: left; margin-top: var(--spacing-xl);">
                                            <div style="font-weight: 600; margin-bottom: var(--spacing-sm); color: white;">Миссия alimOS</div>
                                            <div style="opacity: 0.9; line-height: 1.6; color: rgba(255, 255, 255, 0.9);">
                                                alimOS — это футуристичная мобильная операционная система, созданная для обеспечения спокойного, интуитивного и эстетичного взаимодействия с технологиями. Мы верим в минимализм, красоту и функциональность.
                                            </div>
                                            
                                            <div style="margin-top: var(--spacing-xl); font-weight: 600; margin-bottom: var(--spacing-sm); color: white;">Особенности</div>
                                            <ul style="opacity: 0.9; padding-left: var(--spacing-lg); line-height: 1.6; color: rgba(255, 255, 255, 0.9);">
                                                <li>Уникальный дизайн "calm futuristic minimal"</li>
                                                <li>Плавные анимации и жесты</li>
                                                <li>Полная офлайн-работа</li>
                                                <li>Интегрированные приложения</li>
                                                <li>Настраиваемые темы</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            `;
                            break;
                    }
                };
                
                window.closeSetting = function() {
                    generateSettingsApp(document.querySelector('.app-content'));
                };
                
                window.setTheme = function(theme) {
                    alimOS.state.theme = theme;
                    
                    if (theme === 'dark') {
                        document.body.classList.add('dark');
                    } else {
                        document.body.classList.remove('dark');
                    }
                    
                    saveToStorage();
                    applyTheme();
                    showToast(`Тема: ${theme === 'dark' ? 'Тёмная' : 'Светлая'}`, theme === 'dark' ? '🌙' : '☀️');
                };
                
                window.setAccentColor = function(color) {
                    alimOS.state.accentColor = color;
                    document.documentElement.style.setProperty('--color-primary', color);
                    saveToStorage();
                    showToast('Акцентный цвет изменён', '🎨');
                };
                
                // Генератор приложения Clock
                function generateClockApp(container) {
                    const now = new Date();
                    const timeStr = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit', second: '2-digit'});
                    
                    container.innerHTML = `
                        <div class="clock-container">
                            <div class="clock-face" id="clockTime">${timeStr}</div>
                            
                            <div style="margin-top: var(--spacing-xl); width: 100%; max-width: 300px;">
                                <div style="font-weight: 600; margin-bottom: var(--spacing-md); color: white;">Будильники</div>
                                <div class="alarm-list">
                                    <div class="alarm-item">
                                        <div>
                                            <div style="font-weight: 500;">07:30</div>
                                            <div style="font-size: 12px; opacity: 0.7;">Будние дни</div>
                                        </div>
                                        <div style="width: 40px; height: 20px; background: var(--gradient-primary); border-radius: 10px; position: relative;">
                                            <div style="position: absolute; right: 2px; top: 2px; width: 16px; height: 16px; background: white; border-radius: 8px;"></div>
                                        </div>
                                    </div>
                                    <div class="alarm-item">
                                        <div>
                                            <div style="font-weight: 500;">09:00</div>
                                            <div style="font-size: 12px; opacity: 0.7;">Выходные</div>
                                        </div>
                                        <div style="width: 40px; height: 20px; background: rgba(255, 255, 255, 0.2); border-radius: 10px; position: relative;">
                                            <div style="position: absolute; left: 2px; top: 2px; width: 16px; height: 16px; background: white; border-radius: 8px;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="timer-controls">
                                <button class="timer-btn" onclick="startTimer()">Таймер 25:00</button>
                                <button class="timer-btn" onclick="startStopwatch()">Секундомер</button>
                            </div>
                        </div>
                    `;
                    
                    // Обновление времени каждую секунду
                    if (window.clockInterval) clearInterval(window.clockInterval);
                    window.clockInterval = setInterval(() => {
                        const now = new Date();
                        const timeStr = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit', second: '2-digit'});
                        const clockTime = document.getElementById('clockTime');
                        if (clockTime) clockTime.textContent = timeStr;
                    }, 1000);
                }
                
                window.startTimer = function() {
                    showToast('Таймер запущен на 25:00', '⏱️');
                    vibrate();
                };
                
                window.startStopwatch = function() {
                    showToast('Секундомер запущен', '⏱️');
                    vibrate();
                };
                
                // Генератор приложения Weather
                function generateWeatherApp(container) {
                    container.innerHTML = `
                        <div class="weather-container">
                            <div class="weather-current">
                                <div style="font-size: 18px;">Сегодня</div>
                                <div class="weather-temp">22°</div>
                                <div class="weather-condition">Солнечно</div>
                                <div class="weather-location">Владивосток</div>
                            </div>
                            
                            <div style="margin-top: var(--spacing-xl);">
                                <div style="font-weight: 600; margin-bottom: var(--spacing-md);">Прогноз на 3 дня</div>
                                <div class="weather-forecast">
                                    <div class="forecast-day">
                                        <div>Завтра</div>
                                        <div style="font-size: 24px; margin: var(--spacing-sm) 0;">24°</div>
                                        <div>☀️</div>
                                    </div>
                                    <div class="forecast-day">
                                        <div>Ср</div>
                                        <div style="font-size: 24px; margin: var(--spacing-sm) 0;">20°</div>
                                        <div>⛅</div>
                                    </div>
                                    <div class="forecast-day">
                                        <div>Чт</div>
                                        <div style="font-size: 24px; margin: var(--spacing-sm) 0;">18°</div>
                                        <div>🌧️</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                };
                
                // Генератор приложения Files
                function generateFilesApp(container) {
                    container.innerHTML = `
                        <div class="files-container">
                            <div class="file-list">
                                <div class="file-item">
                                    <div class="file-icon">📁</div>
                                    <div class="file-info">
                                        <div class="file-name">Документы</div>
                                        <div class="file-size">12 файлов</div>
                                    </div>
                                </div>
                                <div class="file-item">
                                    <div class="file-icon">🖼️</div>
                                    <div class="file-info">
                                        <div class="file-name">Изображения</div>
                                        <div class="file-size">${alimOS.data.photos.length} фото</div>
                                    </div>
                                </div>
                                <div class="file-item">
                                    <div class="file-icon">🎵</div>
                                    <div class="file-info">
                                        <div class="file-name">Музыка</div>
                                        <div class="file-size">8 треков</div>
                                    </div>
                                </div>
                                <div class="file-item">
                                    <div class="file-icon">📄</div>
                                    <div class="file-info">
                                        <div class="file-name">Заметки</div>
                                        <div class="file-size">${alimOS.data.notes.length} файлов</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                };
                
                // Генератор приложения Calculator
                function generateCalculatorApp(container) {
                    container.innerHTML = `
                        <div class="calculator">
                            <div class="calculator-display" id="calcDisplay">0</div>
                            <div class="calculator-buttons">
                                <button class="calc-btn" onclick="calcInput('C')">C</button>
                                <button class="calc-btn" onclick="calcInput('±')">±</button>
                                <button class="calc-btn" onclick="calcInput('%')">%</button>
                                <button class="calc-btn operation" onclick="calcInput('/')">÷</button>
                                
                                <button class="calc-btn" onclick="calcInput('7')">7</button>
                                <button class="calc-btn" onclick="calcInput('8')">8</button>
                                <button class="calc-btn" onclick="calcInput('9')">9</button>
                                <button class="calc-btn operation" onclick="calcInput('*')">×</button>
                                
                                <button class="calc-btn" onclick="calcInput('4')">4</button>
                                <button class="calc-btn" onclick="calcInput('5')">5</button>
                                <button class="calc-btn" onclick="calcInput('6')">6</button>
                                <button class="calc-btn operation" onclick="calcInput('-')">−</button>
                                
                                <button class="calc-btn" onclick="calcInput('1')">1</button>
                                <button class="calc-btn" onclick="calcInput('2')">2</button>
                                <button class="calc-btn" onclick="calcInput('3')">3</button>
                                <button class="calc-btn operation" onclick="calcInput('+')">+</button>
                                
                                <button class="calc-btn" onclick="calcInput('0')" style="grid-column: span 2;">0</button>
                                <button class="calc-btn" onclick="calcInput('.')">.</button>
                                <button class="calc-btn equals" onclick="calcInput('=')">=</button>
                            </div>
                        </div>
                    `;
                };
                
                let calcValue = '0';
                let calcOperator = '';
                let calcPreviousValue = '';
                
                window.calcInput = function(input) {
                    const display = document.getElementById('calcDisplay');
                    
                    if ('0123456789'.includes(input)) {
                        if (calcValue === '0' || calcOperator === '=') {
                            calcValue = input;
                        } else {
                            calcValue += input;
                        }
                        display.textContent = calcValue;
                    }
                    else if (input === '.') {
                        if (!calcValue.includes('.')) {
                            calcValue += '.';
                            display.textContent = calcValue;
                        }
                    }
                    else if (input === 'C') {
                        calcValue = '0';
                        calcOperator = '';
                        calcPreviousValue = '';
                        display.textContent = calcValue;
                    }
                    else if (input === '±') {
                        calcValue = String(-parseFloat(calcValue));
                        display.textContent = calcValue;
                    }
                    else if (input === '%') {
                        calcValue = String(parseFloat(calcValue) / 100);
                        display.textContent = calcValue;
                    }
                    else if ('+-*/'.includes(input)) {
                        if (calcPreviousValue && calcOperator) {
                            calcValue = String(calculate(parseFloat(calcPreviousValue), parseFloat(calcValue), calcOperator));
                            display.textContent = calcValue;
                        }
                        calcPreviousValue = calcValue;
                        calcValue = '0';
                        calcOperator = input;
                    }
                    else if (input === '=') {
                        if (calcPreviousValue && calcOperator) {
                            calcValue = String(calculate(parseFloat(calcPreviousValue), parseFloat(calcValue), calcOperator));
                            display.textContent = calcValue;
                            calcPreviousValue = '';
                            calcOperator = '=';
                        }
                    }
                    
                    vibrate();
                };
                
                function calculate(a, b, op) {
                    switch(op) {
                        case '+': return a + b;
                        case '-': return a - b;
                        case '*': return a * b;
                        case '/': return a / b;
                        default: return b;
                    }
                }
                
                // Генератор приложения Browser
                function generateBrowserApp(container) {
                    container.innerHTML = `
                        <div class="browser-container">
                            <div class="browser-header">
                                <button class="btn-back" onclick="window.closeApp()" style="background: rgba(255, 255, 255, 0.2);">←</button>
                                <input type="text" class="browser-url-bar" value="https://alimos.dev" id="browserUrl" readonly>
                                <button style="width: 36px; height: 36px; border-radius: var(--radius-md); background: rgba(255, 255, 255, 0.2); border: none; color: white; font-size: 18px;" onclick="refreshBrowser()">↻</button>
                            </div>
                            <div class="browser-content">
                                <div class="browser-page">
                                    <h1>Добро пожаловать в alimOS</h1>
                                    <p>Это встроенный браузер alimOS, демонстрирующий возможности веб-просмотра в операционной системе.</p>
                                    <p>Вы можете просматривать веб-страницы, хотя в демо-режиме навигация ограничена.</p>
                                    
                                    <h2 style="margin-top: var(--spacing-xl);">Особенности alimOS</h2>
                                    <ul style="line-height: 1.6; margin-bottom: var(--spacing-md);">
                                        <li>Уникальный футуристичный дизайн</li>
                                        <li>Плавные анимации и жесты</li>
                                        <li>Полная офлайн-работа</li>
                                        <li>Интегрированные приложения</li>
                                        <li>Настраиваемые темы</li>
                                    </ul>
                                    
                                    <div style="background: #f5f5f5; padding: var(--spacing-md); border-radius: var(--radius-md); margin-top: var(--spacing-xl);">
                                        <h3>Техническая информация</h3>
                                        <p>Этот браузер работает на движке alimOS Browser Engine v1.0</p>
                                        <p>Версия ОС: ${alimOS.version}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                };
                
                window.refreshBrowser = function() {
                    showToast('Страница обновлена', '↻');
                    vibrate();
                };
                
                // Инициализация демо-данных
                function initDemoData() {
                    // Демо сообщения
                    if (!alimOS.data.messages || alimOS.data.messages.length === 0) {
                        alimOS.data.messages = [
                            {
                                id: 'alim',
                                name: 'Поддержка alimOS',
                                messages: [
                                    {text: 'Добро пожаловать в alimOS!', incoming: true, time: '10:00'},
                                    {text: 'Это сообщение демонстрирует работу чата.', incoming: true, time: '10:01'},
                                    {text: 'Вы можете отвечать на сообщения.', incoming: false, time: '10:05'}
                                ]
                            },
                            {
                                id: 'eva',
                                name: 'Eva',
                                messages: [
                                    {text: 'Привет! Как тебе новая ОС?', incoming: true, time: '09:30'},
                                    {text: 'Мне очень нравится дизайн!', incoming: false, time: '09:35'},
                                    {text: 'Да, он действительно уникальный. Жду твоего фидбека!', incoming: true, time: '09:40'}
                                ]
                            }
                        ];
                    }
                    
                    // Демо заметки
                    if (!alimOS.data.notes || alimOS.data.notes.length === 0) {
                        alimOS.data.notes = [
                            {
                                id: 'demo1',
                                title: 'Добро пожаловать в alimOS',
                                content: 'Это ваша первая заметка. Нажмите, чтобы редактировать.\n\nalimOS предлагает чистый, минималистичный интерфейс с футуристичным дизайном.',
                                created: new Date().toISOString()
                            },
                            {
                                id: 'demo2',
                                title: 'Идеи для приложений',
                                content: 'Подумать о новых функциях для ОС:\n1. Распознавание жестов\n2. ИИ-ассистент\n3. Умные виджеты\n4. Интеграция с IoT',
                                created: new Date().toISOString()
                            }
                        ];
                    }
                    
                    // Демо звонки
                    if (!alimOS.data.calls || alimOS.data.calls.length === 0) {
                        alimOS.data.calls = [
                            {number: '+7 123 456-78-90', time: '10:30', type: 'incoming'},
                            {number: 'Поддержка alimOS', time: '09:15', type: 'outgoing'},
                            {number: '+7 987 654-32-10', time: 'Вчера', type: 'missed'}
                        ];
                    }
                }
                
                // Инициализация быстрых настроек
                function initQuickSettings() {
                    const settings = [
                        {id: 'wifi', label: 'Wi-Fi', icon: '📶', active: alimOS.state.wifi},
                        {id: 'bluetooth', label: 'Bluetooth', icon: '🔵', active: alimOS.state.bluetooth},
                        {id: 'sound', label: 'Звук', icon: '🔊', active: alimOS.state.sound},
                        {id: 'dark', label: 'Тёмная', icon: '🌙', active: alimOS.state.theme === 'dark'},
                        {id: 'airplane', label: 'Авиарежим', icon: '✈️', active: false},
                        {id: 'flashlight', label: 'Фонарик', icon: '🔦', active: false},
                        {id: 'battery', label: 'Экономия', icon: '🔋', active: false},
                        {id: 'settings', label: 'Настройки', icon: '⚙️', active: false}
                    ];
                    
                    elements.quickSettings.innerHTML = '';
                    settings.forEach(setting => {
                        const element = document.createElement('div');
                        element.className = `setting-toggle ${setting.active ? 'active' : ''}`;
                        element.innerHTML = `
                            <div class="setting-icon">${setting.icon}</div>
                            <div>${setting.label}</div>
                        `;
                        element.addEventListener('click', () => toggleQuickSetting(setting.id));
                        elements.quickSettings.appendChild(element);
                    });
                }
                
                function toggleQuickSetting(settingId) {
                    let message = '';
                    let icon = '⚙️';
                    
                    switch(settingId) {
                        case 'wifi':
                            alimOS.state.wifi = !alimOS.state.wifi;
                            message = `Wi-Fi: ${alimOS.state.wifi ? 'Вкл' : 'Выкл'}`;
                            icon = alimOS.state.wifi ? '📶' : '📵';
                            break;
                        case 'bluetooth':
                            alimOS.state.bluetooth = !alimOS.state.bluetooth;
                            message = `Bluetooth: ${alimOS.state.bluetooth ? 'Вкл' : 'Выкл'}`;
                            icon = alimOS.state.bluetooth ? '🔵' : '🔴';
                            break;
                        case 'sound':
                            alimOS.state.sound = !alimOS.state.sound;
                            message = `Звук: ${alimOS.state.sound ? 'Вкл' : 'Выкл'}`;
                            icon = alimOS.state.sound ? '🔊' : '🔇';
                            break;
                        case 'dark':
                            setTheme(alimOS.state.theme === 'dark' ? 'light' : 'dark');
                            return;
                        case 'settings':
                            closeNotificationShade();
                            setTimeout(() => openApp('settings'), 300);
                            return;
                        default:
                            message = `${settingId.charAt(0).toUpperCase() + settingId.slice(1)}: Переключено`;
                    }
                    
                    showToast(message, icon);
                    initQuickSettings();
                    vibrate();
                    saveToStorage();
                }
                
                // Инициализация уведомлений
                function initNotifications() {
                    const notifications = [
                        {id: 1, title: 'alimOS', text: 'Добро пожаловать в новую ОС!', time: '10:00'},
                        {id: 2, title: 'Камера', text: 'Фото сохранено в Галерею', time: '09:45'},
                        {id: 3, title: 'Погода', text: 'Сегодня солнечно, +22°', time: '09:30'},
                        {id: 4, title: 'Напоминание', text: 'Запланируйте тестирование ОС', time: 'Вчера'}
                    ];
                    
                    elements.notificationList.innerHTML = '';
                    notifications.forEach(notification => {
                        const element = document.createElement('div');
                        element.className = 'notification';
                        element.innerHTML = `
                            <div class="notification-title">${notification.title}</div>
                            <div class="notification-text">${notification.text}</div>
                            <div class="notification-time">${notification.time}</div>
                        `;
                        elements.notificationList.appendChild(element);
                    });
                }
                
                // Сохранение в localStorage
                function saveToStorage() {
                    try {
                        localStorage.setItem('alimOS_state', JSON.stringify(alimOS.state));
                        localStorage.setItem('alimOS_data', JSON.stringify(alimOS.data));
                    } catch(e) {
                        console.warn('Не удалось сохранить данные:', e);
                    }
                }
                
                // Загрузка из localStorage
                function loadFromStorage() {
                    try {
                        const savedState = localStorage.getItem('alimOS_state');
                        const savedData = localStorage.getItem('alimOS_data');
                        
                        if (savedState) {
                            const parsed = JSON.parse(savedState);
                            Object.assign(alimOS.state, parsed);
                        }
                        
                        if (savedData) {
                            const parsed = JSON.parse(savedData);
                            alimOS.data = parsed;
                        }
                    } catch(e) {
                        console.warn('Не удалось загрузить данные:', e);
                    }
                }
                
                // Применение темы
                function applyTheme() {
                    if (alimOS.state.theme === 'dark') {
                        document.body.classList.add('dark');
                    } else {
                        document.body.classList.remove('dark');
                    }
                    
                    // Применение акцентного цвета
                    if (alimOS.state.accentColor) {
                        document.documentElement.style.setProperty('--color-primary', alimOS.state.accentColor);
                    }
                }
                
                // Экспорт функций в глобальную область видимости
                window.alimOS = alimOS;
                window.showToast = showToast;
                window.vibrate = vibrate;
                window.openApp = openApp;
                window.closeApp = closeApp;
                
                // Автоматическая разблокировка для демо (можно удалить в продакшене)
                setTimeout(() => {
                    if (alimOS.state.locked) {
                        elements.unlockHint.innerHTML = '<span>Демо-режим: нажмите на ручку</span>';
                    }
                }, 3000);
            });
        })();
    </script>
</body>
</html>
